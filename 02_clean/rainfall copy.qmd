
```{python}
import cdsapi
import xarray as xr
# import scipy.io.netcdf as S
# from scipy.io import netcdf
import pandas as pd
from io import StringIO
import numpy as np

import rasterio
import numpy as np
from pyprojroot.here import here
```

```{python}
# ===== 入力ファイル =====
dry_path = here("data/raw/precipitation/dry_season.tif")   # 乾季
wet_path = here("data/raw/precipitation/flooding.tif")   # 雨季
output_path = here("data//precipitation/difference_wet_minus_dry.tif")
    
# ===== TIFF を読み込み =====
with rasterio.open(dry_path) as dry_src, rasterio.open(wet_path) as wet_src:
    
    # メタデータ（GeoTIFF の座標情報・解像度など）をコピー
    meta = dry_src.meta.copy()
    
    # 画像データ読み込み（1バンド想定）
    dry = dry_src.read(1).astype("float32")
    wet = wet_src.read(1).astype("float32")

# ===== 差分（雨季 − 乾季） =====
difference = wet - dry

# ===== 結果を GeoTIFF として保存 =====
meta.update(dtype="float32")

with rasterio.open(output_path, "w", **meta) as dst:
    dst.write(difference, 1)

print("差分画像を保存しました：", output_path)

```